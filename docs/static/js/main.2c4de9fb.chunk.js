(this["webpackJsonpr3f-template"]=this["webpackJsonpr3f-template"]||[]).push([[0],{58:function(e,t,n){},60:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var c=n(1),o=n.n(c),i=n(37),r=n.n(i),s=(n(58),n(8)),a=n(26),j=n(71),u=n(72),b=n(13),f=n(18),l=n(0),O=(n(60),n(3)),p=n(5);var d=function(e){var t=Object(a.b)((function(){return Object(O.a)({mass:.2,position:[0,5,0],velocity:[0,4,0]},e)})),n=Object(s.a)(t,1)[0];return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("mesh",{ref:n,children:[Object(p.jsx)("boxBufferGeometry",{}),Object(p.jsx)("meshPhysicalMaterial",{})]})})},m=n(43),h=function(e){var t=Object(c.useRef)(),n=Object(b.e)(m.a,"/r3f-app"+e.path);return Object(p.jsx)("group",{ref:t,children:Object(p.jsxs)("mesh",{rotation:[Math.PI/2,0,0],children:[Object(p.jsx)("primitive",{object:n.scene,scale:[1.5,1.5,1.5],position:e.position}),";"]})})};var x=function(e){var t=Object(a.c)((function(){return Object(O.a)({rotation:[-Math.PI/2,0,0]},e)})),n=Object(s.a)(t,1)[0];return Object(p.jsxs)("mesh",{ref:n,children:[Object(p.jsx)(h,{path:"/assets/map2/BASKETBALL/BASKETBALL.gltf",position:[15,-24,13]}),Object(p.jsx)(h,{path:"/assets/map2/BASE2/BASE.gltf",position:[15,-24,13]}),Object(p.jsx)(h,{path:"/assets/map2/TEST/TEST.gltf",position:[15,-24,13]})]})},v=n(11);function g(e){return{KeyW:"moveForward",KeyS:"moveBackward",KeyA:"moveLeft",KeyD:"moveRight",Space:"jump"}[e]}var y=Object(f.b)({key:"position",default:{position:[0,0,0],rotation:[0,0,0]}}),k=(Object(f.b)({key:"camera",default:{position:[0,0,0],rotation:[0,0,0]}}),Object(f.b)({key:"socket",default:void 0})),w=function(e){var t=e.position,n=void 0===t?[0,0,0]:t,c=e.offset,o=void 0===c?[0,0,0]:c,i=e.dims,r=void 0===i?[1,1,1]:i,j=e.visible,u=void 0!==j&&j,l=e.children,O=Object(a.b)((function(){return{mass:1,args:r,position:n}})),d=Object(s.a)(O,2),m=d[0],h=d[1],x=Object(f.d)(y),v=x.position,g=x.rotation;return Object(b.d)((function(e){e.clock;h.position.set(v[0],v[1],v[2]),h.rotation.set(g[0],g[1],g[2])})),Object(p.jsxs)("group",{ref:m,api:h,children:[Object(p.jsxs)("mesh",{scale:r,visible:u,children:[Object(p.jsx)("boxBufferGeometry",{}),Object(p.jsx)("meshPhysicalMaterial",{wireframe:!0})]}),Object(p.jsx)("group",{position:o,children:l})]})},L=function(e){var t,n,o,i=Object(c.useRef)(),r=Object(c.useState)(0),a=Object(s.a)(r,2),u=a[0],d=a[1],h=Object(c.useRef)(),x=function(){var e=Object(c.useState)({moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1,jump:!1}),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(c.useEffect)((function(){var e=function(e){o((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(v.a)({},g(e.code),!0))}))},t=function(e){o((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(v.a)({},g(e.code),!1))}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),n}(),k=x.moveForward,L=x.moveBackward,E=x.moveLeft,S=x.moveRight,A=e.path,B=Object(b.e)(m.a,A),F=Object(f.e)(y),T=Object(b.f)().camera,R=(o=new l.AnimationMixer(B.scene)).clipAction(B.animations[null!==(t=e.idleIndex)&&void 0!==t?t:0]),I=o.clipAction(B.animations[null!==(n=e.walkIndex)&&void 0!==n?n:1]);return B.animations.length>0&&o.stopAllAction(),Object(b.d)((function(e,t){d(k|L|E|S?1:0),o.update(t)})),Object(b.d)((function(e){e.clock;var t=new l.Vector3,n=new l.Vector3(0,0,Number(L)-Number(k)),c=new l.Vector3(Number(E)-Number(S),0,0);t.subVectors(n,c).normalize().multiplyScalar(.1).applyEuler(T.rotation),F((function(e){var n=[e.position[0]+t.x,1,e.position[2]+t.z],c=T.rotation.toArray();return i.current.target.position=new l.Vector3(n[0],T.position.y,n[2]),{position:n,rotation:[0,c[2]+Math.PI,0]}}))})),Object(c.useEffect)((function(){if(o.stopAllAction(),1===u)I.setLoop(l.LoopRepeat),I.play();else R.setLoop(l.LoopRepeat),R.play()}),[u,I,R,o]),Object(p.jsx)("group",{ref:h,up:[0,1,0],children:Object(p.jsxs)(w,{visible:!0,up:[0,0,0],position:[0,2.4,0],dims:[1.5,2,1.5],rotation:[0,0,0],children:[Object(p.jsx)(j.a,{ref:i}),Object(p.jsx)("primitive",{object:B.scene,path:e.path,scale:[2,2,2],position:[0,-1,0]})]})})},E=["px.png","nx.png","py.png","ny.png","nz.png","pz.png"].map((function(e){return"/assets/skyboxes/city/"+e}));function S(){return function(e){var t=Object(b.f)().scene;Object(c.useEffect)((function(){var n=(new l.CubeTextureLoader).load(e);t.background=n,t.environment=n}),[e,t.background,t])}(E),Object(p.jsx)(p.Fragment,{})}function A(e,t){return Math.random()*(t-e)+e}function B(){var e=Object(c.useRef)();return Object(b.d)((function(t){console.log("orbitRef.current.target.position",e.current.target.position),e.current.target.position=new l.Vector3(3*Math.sin(.5*t),0,0),e.current.update()})),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("ambientLight",{intensity:.2}),Object(p.jsx)("pointLight",{position:[70,100,0],color:"blue",intensity:20}),Object(p.jsx)("pointLight",{position:[-70,80,-20],color:"pink",intensity:20}),Object(p.jsx)(j.a,{ref:e,minDistance:1,maxDistance:20,target:[0,2.5,0]}),Object(p.jsx)(S,{}),Object(p.jsxs)(c.Suspense,{fallback:null,children:[Object(p.jsx)(x,{}),new Array(15).fill(0).map((function(e){return Object(p.jsx)(d,{position:[A(-4,4),A(1,10),A(-4,4)],scale:[.1,.1,.15],rotation:[A(.1,25),0,0]})})),Object(p.jsx)(L,{path:"/r3f-appassets/marie_survivor/scene.gltf",walkIndex:15,idleIndex:0})]})]})}var F=function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(b.a,{camera:{position:[7,7,7]},children:Object(p.jsxs)(f.a,{children:[Object(p.jsx)(a.a,{children:Object(p.jsx)(B,{})}),Object(p.jsx)(u.a,{})]})})})},T=n(12),R=n(53);function I(){var e=R.a.connect("http://localhost:9000",{transports:["websocket"]}),t=Object(c.useState)(0),n=Object(s.a)(t,2),o=n[0],i=(n[1],Object(c.useState)(["yo"])),r=Object(s.a)(i,2),a=r[0],j=r[1],u=Object(f.c)(k),b=Object(s.a)(u,2);b[0];(0,b[1])(e);return Object(c.useEffect)((function(){return e.on("connect",(function(t){e.emit("message-client","\uc5f0\uacb0\ub428."),console.log("connected",t),e.emit("name","Tom")})),e.on("seq-num",(function(e){console.info(e)})),e.on("message",(function(e){console.info(e)})),e.emit("end")}),[]),Object(c.useEffect)((function(){var e;e="count ".concat(o),j((function(t){return[].concat(Object(T.a)(t),[e])}))}),[o]),Object(p.jsxs)("div",{children:[Object(p.jsx)("button",{onClick:function(){e.emit("message-client","Tom")},children:"asdfa"}),a.map((function(e,t){return Object(p.jsxs)("div",{children:[e,Object(p.jsx)("br",{})]},"".concat(e,"-").concat(t))}))]})}var M=function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(I,{})})};var C=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(p.jsx)("div",{style:{width:"100%",height:"100%"},children:1===n?Object(p.jsx)(F,{}):2===n?Object(p.jsx)(M,{}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return o(1)},children:"\uc2dc\uc791\ud558\uae301"}),Object(p.jsx)("button",{onClick:function(){return o(2)},children:"\uc2dc\uc791\ud558\uae302"})]})})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,73)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),o(e),i(e),r(e)}))};r.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(C,{})}),document.getElementById("root")),P()}},[[69,1,2]]]);
//# sourceMappingURL=main.2c4de9fb.chunk.js.map