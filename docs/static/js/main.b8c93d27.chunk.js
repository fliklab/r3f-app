(this["webpackJsonpr3f-template"]=this["webpackJsonpr3f-template"]||[]).push([[0],{46:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var c=n(5),o=n.n(c),i=n(29),r=n.n(i),s=(n(46),n(9)),a=n(21),j=n(55),u=n(15),b=n(19),l=n(6),p=n(10);var f=function(e){var t=Object(a.b)((function(){return Object(l.a)({mass:.2,position:[0,5,0],velocity:[0,4,0]},e)})),n=Object(s.a)(t,1)[0];return Object(p.jsxs)("mesh",{ref:n,children:[Object(p.jsx)("boxBufferGeometry",{}),Object(p.jsx)("meshPhysicalMaterial",{})]})},O="https://fliklab.github.io/r3f-app",d=n(35),m=function(e){var t=Object(c.useRef)(),n=Object(u.e)(d.a,e.path);return Object(p.jsx)("mesh",{ref:t,rotation:[Math.PI/2,0,0],children:Object(p.jsx)("primitive",{object:n.scene,scale:[1.5,1.5,1.5],position:e.position})})};var h=function(e){var t=Object(a.c)((function(){return Object(l.a)({rotation:[-Math.PI/2,0,0]},e)})),n=Object(s.a)(t,1)[0];return Object(p.jsxs)("mesh",{ref:n,receiveShadow:!0,children:[Object(p.jsx)(m,{path:O+"/assets/map2/BASKETBALL/BASKETBALL.gltf",position:[15,-24,13]}),Object(p.jsx)(m,{path:O+"/assets/map2/BASE2/BASE.gltf",position:[15,-24,13]}),Object(p.jsx)(m,{path:O+"/assets/map2/TEST/test.gltf",position:[15,-24,13]})]})},v=n(54),x=n(1),g=n(13);function y(e){return{KeyW:"moveForward",KeyS:"moveBackward",KeyA:"moveLeft",KeyD:"moveRight",Space:"jump"}[e]}var w=Object(b.b)({key:"position",default:{position:[0,0,0],rotation:[0,0,0]}}),k=(Object(b.b)({key:"camera",default:{position:[0,0,0],rotation:[0,0,0]}}),function(e){var t=e.position,n=void 0===t?[0,0,0]:t,c=e.offset,o=void 0===c?[0,0,0]:c,i=e.dims,r=void 0===i?[1,1,1]:i,j=e.visible,l=void 0!==j&&j,f=e.children,O=Object(a.b)((function(){return{mass:1,args:r,position:n}})),d=Object(s.a)(O,2),m=d[0],h=d[1],v=Object(b.c)(w),x=v.position,g=v.rotation;return Object(u.d)((function(e){e.clock;h.position.set(x[0],x[1],x[2]),h.rotation.set(g[0],g[1],g[2])})),Object(p.jsxs)("group",{ref:m,api:h,children:[Object(p.jsxs)("mesh",{scale:r,visible:l,children:[Object(p.jsx)("boxBufferGeometry",{}),Object(p.jsx)("meshPhysicalMaterial",{wireframe:!0})]}),Object(p.jsx)("group",{position:o,children:f})]})}),A=function(e){var t,n,o,i=Object(c.useRef)(),r=Object(c.useState)(0),a=Object(s.a)(r,2),j=a[0],f=a[1],O=Object(c.useRef)(),m=function(){var e=Object(c.useState)({moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1,jump:!1}),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(c.useEffect)((function(){var e=function(e){o((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(g.a)({},y(e.code),!0))}))},t=function(e){o((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(g.a)({},y(e.code),!1))}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),n}(),h=m.moveForward,A=m.moveBackward,L=m.moveLeft,S=m.moveRight,E=e.path,B=Object(u.e)(d.a,E),F=B.nodes,M=B.scene,I=B.animations,R=Object(b.d)(w),P=Object(u.f)().camera;Object(c.useMemo)((function(){return Object.values(F).forEach((function(e){return e instanceof x.Mesh&&Object.assign(e,{castShadow:!0,receiveShadow:!0})}))}),[F]);var T=(o=new x.AnimationMixer(M)).clipAction(I[null!==(t=e.idleIndex)&&void 0!==t?t:0]),C=o.clipAction(I[null!==(n=e.walkIndex)&&void 0!==n?n:1]);return I.length>0&&o.stopAllAction(),Object(u.d)((function(e,t){f(h|A|L|S?1:0),o.update(t)})),Object(u.d)((function(e){e.clock;var t=new x.Vector3,n=new x.Vector3(0,0,Number(A)-Number(h)),c=new x.Vector3(Number(L)-Number(S),0,0);t.subVectors(n,c).normalize().multiplyScalar(.1).applyEuler(P.rotation),R((function(e){var n=[e.position[0]+t.x,1,e.position[2]+t.z],c=P.rotation.toArray();return console.log(c),P.position.copy(new x.Vector3(n[0]+10*Math.sin(c[1]),3,n[2]+10*Math.cos(c[1]))),i.current.target=new x.Vector3(n[0],P.position.y,n[2]),i.current.update(),{position:n,rotation:[0,c[1]+Math.PI,0]}}))})),Object(c.useEffect)((function(){if(o.stopAllAction(),1===j)C.setLoop(x.LoopRepeat),C.play();else T.setLoop(x.LoopRepeat),T.play()}),[j,C,T,o]),Object(p.jsxs)("group",{ref:O,up:[0,1,0],children:[Object(p.jsx)(v.a,{ref:i}),Object(p.jsxs)(k,{visible:!0,up:[0,0,0],dims:[1.5,2,1.5],children:[Object(p.jsx)("primitive",{object:M,path:e.path,scale:[2,2,2],position:[0,-1,0]}),Object(p.jsx)("boxBufferGeometry",{scale:[2,2,2]})]})]})},L=["px.png","nx.png","py.png","ny.png","nz.png","pz.png"].map((function(e){return"/assets/skyboxes/city/"+e}));function S(){return function(e){var t=Object(u.f)().scene;Object(c.useEffect)((function(){var n=(new x.CubeTextureLoader).load(e);t.background=n,t.environment=n}),[e,t.background,t])}(L),Object(p.jsx)(p.Fragment,{})}function E(e,t){return Math.random()*(t-e)+e}n(51);function B(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("ambientLight",{intensity:.2,color:"#FAAD37"}),Object(p.jsx)("directionalLight",{position:[70,100,0],color:"#FAAD37",intensity:1}),Object(p.jsx)(S,{}),Object(p.jsxs)(c.Suspense,{fallback:null,children:[Object(p.jsx)(h,{}),new Array(15).fill(0).map((function(e){return Object(p.jsx)(f,{position:[E(-4,4),E(1,10),E(-4,4)],scale:[.1,.1,.15],rotation:[E(.1,25),0,0]})})),Object(p.jsx)(A,{path:"assets/marie_survivor/scene.gltf",walkIndex:15,idleIndex:0})]})]})}var F=function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(u.a,{camera:{position:[7,7,7]},children:Object(p.jsxs)(b.a,{children:[Object(p.jsx)(a.a,{children:Object(p.jsx)(B,{})}),Object(p.jsx)(j.a,{})]})})})};var M=function(){return Object(p.jsx)(p.Fragment,{})};var I=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(p.jsx)("div",{style:{width:"100%",height:"100%"},children:1===n?Object(p.jsx)(F,{}):2===n?Object(p.jsx)(M,{}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{onClick:function(){return o(1)},children:"\uc2dc\uc791\ud558\uae301"}),Object(p.jsx)("button",{onClick:function(){return o(2)},children:"\uc2dc\uc791\ud558\uae302"})]})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,56)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),o(e),i(e),r(e)}))};r.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(I,{})}),document.getElementById("root")),R()}},[[52,1,2]]]);
//# sourceMappingURL=main.b8c93d27.chunk.js.map